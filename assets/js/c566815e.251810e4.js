"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[5912],{11470:(e,r,t)=>{t.d(r,{A:()=>j});var s=t(96540),n=t(18215),a=t(23104),i=t(56347),o=t(205),l=t(57485),c=t(31682),u=t(70679);function d(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:r,children:t}=e;return(0,s.useMemo)((()=>{const e=r??function(e){return d(e).map((e=>{let{props:{value:r,label:t,attributes:s,default:n}}=e;return{value:r,label:t,attributes:s,default:n}}))}(t);return function(e){const r=(0,c.XI)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,t])}function p(e){let{value:r,tabValues:t}=e;return t.some((e=>e.value===r))}function g(e){let{queryString:r=!1,groupId:t}=e;const n=(0,i.W6)(),a=function(e){let{queryString:r=!1,groupId:t}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:r,groupId:t});return[(0,l.aZ)(a),(0,s.useCallback)((e=>{if(!a)return;const r=new URLSearchParams(n.location.search);r.set(a,e),n.replace({...n.location,search:r.toString()})}),[a,n])]}function m(e){const{defaultValue:r,queryString:t=!1,groupId:n}=e,a=h(e),[i,l]=(0,s.useState)((()=>function(e){let{defaultValue:r,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!p({value:r,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:r,tabValues:a}))),[c,d]=g({queryString:t,groupId:n}),[m,y]=function(e){let{groupId:r}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(r),[n,a]=(0,u.Dv)(t);return[n,(0,s.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:n}),f=(()=>{const e=c??m;return p({value:e,tabValues:a})?e:null})();(0,o.A)((()=>{f&&l(f)}),[f]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),y(e)}),[d,y,a]),tabValues:a}}var y=t(92303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(74848);function x(e){let{className:r,block:t,selectedValue:s,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),u=e=>{const r=e.currentTarget,t=l.indexOf(r),n=o[t].value;n!==s&&(c(r),i(n))},d=e=>{let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;r=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;r=l[t]??l[l.length-1];break}}r?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.A)("tabs",{"tabs--block":t},r),children:o.map((e=>{let{value:r,label:t,attributes:a}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:s===r?0:-1,"aria-selected":s===r,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...a,className:(0,n.A)("tabs__item",f.tabItem,a?.className,{"tabs__item--active":s===r}),children:t??r},r)}))})}function v(e){let{lazy:r,children:t,selectedValue:a}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(r){const e=i.find((e=>e.props.value===a));return e?(0,s.cloneElement)(e,{className:(0,n.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map(((e,r)=>(0,s.cloneElement)(e,{key:r,hidden:e.props.value!==a})))})}function k(e){const r=m(e);return(0,b.jsxs)("div",{className:(0,n.A)("tabs-container",f.tabList),children:[(0,b.jsx)(x,{...r,...e}),(0,b.jsx)(v,{...r,...e})]})}function j(e){const r=(0,y.A)();return(0,b.jsx)(k,{...e,children:d(e.children)},String(r))}},19365:(e,r,t)=>{t.d(r,{A:()=>i});t(96540);var s=t(18215);const n={tabItem:"tabItem_Ymn6"};var a=t(74848);function i(e){let{children:r,hidden:t,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.A)(n.tabItem,i),hidden:t,children:r})}},28453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>o});var s=t(96540);const n={},a=s.createContext(n);function i(e){const r=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(a.Provider,{value:r},e.children)}},92984:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>u,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"ske/installing-ske/air-gapped","title":"Air-gapped installation","description":"Installing and running Syntasso Kratix Enterprise in air-gapped environments","source":"@site/docs/ske/01-installing-ske/03-air-gapped.mdx","sourceDirName":"ske/01-installing-ske","slug":"/ske/installing-ske/air-gapped","permalink":"/ske/installing-ske/air-gapped","draft":false,"unlisted":false,"editUrl":"https://github.com/syntasso/kratix-docs/tree/main/docs/ske/01-installing-ske/03-air-gapped.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Air-gapped installation","description":"Installing and running Syntasso Kratix Enterprise in air-gapped environments"},"sidebar":"skeSidebar","previous":{"title":"Advanced installation","permalink":"/ske/installing-ske/advanced-install"},"next":{"title":"Upgrades","permalink":"/ske/installing-ske/upgrades"}}');var n=t(74848),a=t(28453),i=t(11470),o=t(19365);const l={title:"Air-gapped installation",description:"Installing and running Syntasso Kratix Enterprise in air-gapped environments"},c=void 0,u={},d=[{value:"Image Registry",id:"image-registry",level:2},{value:"Providing SKE Operator access to use your image registry",id:"providing-ske-operator-access-to-use-your-image-registry",level:3},{value:"SKE Release Storage",id:"ske-release-storage",level:2},{value:"Providing SKE Operator access to use your release registry",id:"providing-ske-operator-access-to-use-your-release-registry",level:3},{value:"Install SKE via the Helm chart",id:"install-ske-via-the-helm-chart",level:2}];function h(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:"You may want to manage SKE manifests and images within your own environment either\ndue to air-gapped requirements or other security and redundancy measures."}),"\n",(0,n.jsx)(r.p,{children:"Regardless of the reason, if you want to host your own manifests and/or images you\nwill need to ensure that your Platform cluster has access to the following resources:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"An image registry containing the SKE Operator and additional SKE integration images"}),"\n",(0,n.jsx)(r.li,{children:"A location where the SKE Release manifests can be found"}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Depending on your environment configuration, you will be instructed how to create\nconfiguration and secrets the SKE Operator requires to access both the Image\nRegistry and manifest locations."}),"\n",(0,n.jsx)(r.p,{children:"Manifests include reference to the SKE docker images. Do not directly change the manifest\nto reference your image storage. If you need to change the image locations, you can do so\nby using the image registry configuration fields on the SKE Operator which is documented\nbelow."}),"\n",(0,n.jsxs)(r.admonition,{type:"note",children:[(0,n.jsxs)(r.p,{children:["The user associated with your SKE licence is ",(0,n.jsx)(r.code,{children:"syntasso-pkg"}),". To pull the images\nfrom the Syntasso Registry, first login with:"]}),(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"docker login --username syntasso-pkg registry.syntasso.io\n"})}),(0,n.jsx)(r.p,{children:"You will be prompted for a password. The password is your Licence Key."}),(0,n.jsxs)(r.p,{children:["Once you have logged in, you can pull the images using the ",(0,n.jsx)(r.code,{children:"docker pull"}),"\ncommand."]})]}),"\n",(0,n.jsx)(r.h2,{id:"image-registry",children:"Image Registry"}),"\n",(0,n.jsx)(r.p,{children:"The SKE Operator and SKE images are stored in the GitHub Container Registry (GHCR)."}),"\n",(0,n.jsx)(r.p,{children:"You must ensure that the following images are mirrored to your own image registry and\ntagged according to the version."}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.code,{children:"registry.syntasso.io/syntasso/ske-operator"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.code,{children:"registry.syntasso.io/syntasso/ske-platform"})}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["You can find the available versions of the images in the ",(0,n.jsx)(r.a,{href:"http://syntasso-enterprise-releases.s3-website.eu-west-2.amazonaws.com/",children:"Syntasso Enterprise\nReleases page"}),"."]}),"\n",(0,n.jsxs)(r.admonition,{type:"tip",children:[(0,n.jsxs)(r.p,{children:["You can use ",(0,n.jsx)(r.a,{href:"https://github.com/containers/skopeo",children:"Skopeo"})," to mirror container\nimages between registries. When using Skopeo, ",(0,n.jsxs)(r.strong,{children:["always reference the Syntasso\nregistry via ",(0,n.jsx)(r.code,{children:"ghcr.io"})," rather than ",(0,n.jsx)(r.code,{children:"registry.syntasso.io"})]}),", because Skopeo does not\ncorrectly follow redirect responses used by the latter."]}),(0,n.jsxs)(r.p,{children:["Below is an example of copying the image ",(0,n.jsx)(r.code,{children:"registry.syntasso.io/syntasso/ske-operator:latest"})," to\nyour own registry, substituting ghcr.io as the source:"]}),(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"skopeo copy --retry-times=2 --all --src-creds=syntasso-pkg:${SYNTASSO_TOKEN} --dest-creds=${MIRROR_USERNAME}:${MIRROR_PWD} docker://ghcr.io/syntasso/ske-operator:latest docker://registry.my-org.com/syntasso/ske-operator:latest\n"})})]}),"\n",(0,n.jsx)(r.h3,{id:"providing-ske-operator-access-to-use-your-image-registry",children:"Providing SKE Operator access to use your image registry"}),"\n",(0,n.jsx)(r.p,{children:"You need provide the SKE Operator with both the credentials and location to read your\nimage registry."}),"\n",(0,n.jsx)(r.p,{children:"To create the Image Registry secret, run:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'kubectl create secret docker-registry <PULL SECRET NAME> \\\n    --namespace "kratix-platform-system" \\\n    --docker-username="<YOURUSERNAME>" \\\n    --docker-password="<YOURPASSWORD>" \\\n    --docker-server="<YOUR.REGISTRY.ADDRESS>"\n'})}),"\n",(0,n.jsx)(r.p,{children:"You will need to reference this secret when installing SKE operator which is described in\neach installation guide."}),"\n",(0,n.jsx)(r.h2,{id:"ske-release-storage",children:"SKE Release Storage"}),"\n",(0,n.jsxs)(r.p,{children:["The manifests for SKE deployments are available in the ",(0,n.jsx)(r.a,{href:"http://syntasso-enterprise-releases.s3-website.eu-west-2.amazonaws.com/",children:"Syntasso Enterprise\nReleases page"}),"."]}),"\n",(0,n.jsx)(r.p,{children:"You need to host the manifests in your own S3-compatible bucket or Git repository that's\naccessible from the Platform cluster."}),"\n",(0,n.jsx)(r.p,{children:"The contents must match exactly the structure of the Syntasso Enterprise releases bucket."}),"\n",(0,n.jsxs)(r.p,{children:["In Git, all files/directories starting with ",(0,n.jsx)(r.code,{children:"."})," are ignored."]}),"\n",(0,n.jsx)(r.h3,{id:"providing-ske-operator-access-to-use-your-release-registry",children:"Providing SKE Operator access to use your release registry"}),"\n",(0,n.jsx)(r.p,{children:"To create the secret to access the SKE Release Storage:"}),"\n",(0,n.jsxs)(i.A,{className:"boxedTabs",groupId:"stateStore",children:[(0,n.jsx)(o.A,{value:"bucket",label:"Mirroring from Bucket",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'kubectl create secret generic <BUCKET SECRET NAME> \\\n    --namespace kratix-platform-system \\\n    --from-literal=accessKeyID="<YOURACCESSKEY>" \\\n    --from-literal=secretAccessKey="<YOURSECRETKEY>"\n'})})}),(0,n.jsx)(o.A,{value:"git",label:"Mirroring from Git Repo",children:(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'kubectl create secret generic <GIT SECRET NAME> \\\n    --namespace kratix-platform-system \\\n    --from-literal=username="<USERNAME>" \\\n    --from-literal=password="<PASSWORD>"\n'})})})]}),"\n",(0,n.jsx)(r.p,{children:"You will need to reference this secret when installing SKE operator which is described in\neach installation guide."}),"\n",(0,n.jsx)(r.h2,{id:"install-ske-via-the-helm-chart",children:"Install SKE via the Helm chart"}),"\n",(0,n.jsxs)(r.p,{children:["With the mirrors in place, you can install SKE via the Helm chart. Refer to the ",(0,n.jsx)(r.a,{href:"/ske/installing-ske/advanced-install#via-helm-chart",children:"installation guide"})," for more details, and make sure to configure the ",(0,n.jsx)(r.a,{href:"/ske/installing-ske/advanced-install#air-gapped-mirrors",children:"air-gapped mirrors"}),"."]})]})}function p(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}}}]);