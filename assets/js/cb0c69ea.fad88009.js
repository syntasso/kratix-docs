"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[4218],{28453:(e,i,s)=>{s.d(i,{R:()=>t,x:()=>a});var n=s(96540);const o={},r=n.createContext(o);function t(e){const i=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),n.createElement(r.Provider,{value:i},e.children)}},74133:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>t,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"main/reference/promise-upgrade/promise-revisions","title":"Promise Revisions","description":"Documentation for the Kratix PromiseRevision Custom Resource","source":"@site/docs/main/03-reference/16-promise-upgrade/01-promise-revisions.md","sourceDirName":"main/03-reference/16-promise-upgrade","slug":"/main/reference/promise-upgrade/promise-revisions","permalink":"/main/reference/promise-upgrade/promise-revisions","draft":false,"unlisted":false,"editUrl":"https://github.com/syntasso/kratix-docs/tree/main/docs/main/03-reference/16-promise-upgrade/01-promise-revisions.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"description":"Documentation for the Kratix PromiseRevision Custom Resource","title":"Promise Revisions","sidebar_label":"Promise Revisions"},"sidebar":"mainSidebar","previous":{"title":"Promise Upgrade","permalink":"/category/promise-upgrade"},"next":{"title":"Resource Bindings","permalink":"/main/reference/promise-upgrade/resource-bindings"}}');var o=s(74848),r=s(28453);const t={description:"Documentation for the Kratix PromiseRevision Custom Resource",title:"Promise Revisions",sidebar_label:"Promise Revisions"},a="Promise Revisions",l={},d=[{value:"Updating a Promise",id:"updating-a-promise",level:2},{value:"Deleting a Promise Revision",id:"deleting-a-promise-revision",level:2}];function c(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.header,{children:(0,o.jsx)(i.h1,{id:"promise-revisions",children:"Promise Revisions"})}),"\n",(0,o.jsx)(i.p,{children:"Promise Revisions provide a mechanism for locking a Promise to a specific version."}),"\n",(0,o.jsxs)(i.p,{children:["When a Promise is installed, Kratix will automatically create a Promise Revision for that Promise. This Promise Revision\nconsists of a reference to the Promise, the desired version, and the ",(0,o.jsx)(i.code,{children:"spec"})," of the Promise at\nthat version, including the Promise API, dependencies and workflows. This\ninitial Promise Revision will be labeled as the ",(0,o.jsx)(i.code,{children:"latest"})," revision (via the ",(0,o.jsx)(i.code,{children:"kratix.io/latest-revision"})," label)."]}),"\n",(0,o.jsxs)(i.p,{children:["The Resource request for the Promise will be bound to the ",(0,o.jsx)(i.code,{children:"latest"})," Promise Revision via a Resource Binding."]}),"\n",(0,o.jsx)(i.admonition,{type:"info",children:(0,o.jsx)(i.p,{children:"Promise Revisions are fully managed by Kratix. As a Kratix user, you will not need to create or update Promise\nRevisions manually."})}),"\n",(0,o.jsx)(i.p,{children:"A Promise Revision will look like this:"}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-yaml",children:"apiVersion: platform.kratix.io/v1alpha1\nkind: PromiseRevision\nmetadata:\n  labels:\n    kratix.io/promise-name: promise-name\n  name: promise-revision-name\n  # Name of the Promise Revision; this takes the form <PROMISE_NAME>-<VERSION>\nspec:\n  promiseRef:\n    name: promise-name\n  promiseSpec:\n  # The full promise.spec of the Promise\n    api:\n    destinationSelectors:\n    workflows:\n  version: v0.1.0\n  # The version of the Promise as indicated by the kratix.io/promise-version label\nstatus: {}\n"})}),"\n",(0,o.jsx)(i.h2,{id:"updating-a-promise",children:"Updating a Promise"}),"\n",(0,o.jsxs)(i.p,{children:["Kratix will automatically generate a ",(0,o.jsx)(i.code,{children:"latest"})," Promise Revision for the latest applied Promise. When a new\n",(0,o.jsx)(i.em,{children:"version"})," of the Promise is installed, a new Promise Revision will be created reflecting the updated specification at the\nupdated version. This newly created Promise Revision will be become the new ",(0,o.jsx)(i.code,{children:"latest"})," revision."]}),"\n",(0,o.jsxs)(i.p,{children:["For example, if the Redis Promise is initially installed at ",(0,o.jsx)(i.code,{children:"v0.1.0"})," (via the ",(0,o.jsx)(i.code,{children:"kratix.io/promise-version"})," label) and then upgraded to ",(0,o.jsx)(i.code,{children:"v0.2.0"})," (via the same label), there will be two Promise Revisions in the system, with ",(0,o.jsx)(i.code,{children:"v0.2.0"})," labelled as the ",(0,o.jsx)(i.code,{children:"latest"}),"."]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-shell-session",children:"$ kubectl get promiserevisions\nNAME           LATEST\nredis-v0.1.0\nredis-v0.2.0   true\n"})}),"\n",(0,o.jsx)(i.admonition,{type:"tip",children:(0,o.jsxs)(i.p,{children:["When a Promise is installed with no version tag, the Promise Revision will be crated with a ",(0,o.jsx)(i.code,{children:"version"})," configured as ",(0,o.jsx)(i.code,{children:"not set"}),"."]})}),"\n",(0,o.jsx)(i.p,{children:"If a Promise is updated, but the version already has a Promise Revision\nassociated to it, the existing Promise Revision will be updated to reflect the\nupdated Promise spec."}),"\n",(0,o.jsx)(i.admonition,{type:"warning",children:(0,o.jsxs)(i.p,{children:["Kratix ",(0,o.jsx)(i.em,{children:"does not take"})," ",(0,o.jsx)(i.a,{href:"https://semver.org/",children:"semantic versioning"})," into account\nwhen applying the ",(0,o.jsx)(i.code,{children:"latest"})," label, as not all Promises might use. This means that\nif you have version ",(0,o.jsx)(i.code,{children:"0.2.0"})," installed and you install version ",(0,o.jsx)(i.code,{children:"0.1.0"}),", the\n",(0,o.jsx)(i.code,{children:"latest"})," Promise version will be ",(0,o.jsx)(i.code,{children:"0.1.0"})," because it is the most recently\ninstalled Promise."]})}),"\n",(0,o.jsx)(i.h2,{id:"deleting-a-promise-revision",children:"Deleting a Promise Revision"}),"\n",(0,o.jsx)(i.p,{children:"Upon initiating the deletion of a Promise Revision, the Resource Requests created from that Promise Revision will be\ndeleted alongside their Resource Bindings."}),"\n",(0,o.jsx)(i.admonition,{type:"info",children:(0,o.jsxs)(i.p,{children:["The Promise Revision with the ",(0,o.jsx)(i.code,{children:"latest"})," label cannot be deleted, as a result, the Resource Requests will not be\ndeleted. To delete the ",(0,o.jsx)(i.code,{children:"latest"})," Revision, you should delete the Promise."]})})]})}function m(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);