"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[9693],{3831:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>c,toc:()=>u});var a=t(5893),r=t(1151),s=t(4866),i=t(5162);const l={title:"Installation via Helm",description:"Installing Syntasso Kratix Enterprise"},o=void 0,c={id:"ske/kratix/helm-installation",title:"Installation via Helm",description:"Installing Syntasso Kratix Enterprise",source:"@site/docs/ske/01-kratix/11-helm-installation.mdx",sourceDirName:"ske/01-kratix",slug:"/ske/kratix/helm-installation",permalink:"/ske/kratix/helm-installation",draft:!1,unlisted:!1,editUrl:"https://github.com/syntasso/kratix-docs/tree/main/docs/ske/01-kratix/11-helm-installation.mdx",tags:[],version:"current",sidebarPosition:11,frontMatter:{title:"Installation via Helm",description:"Installing Syntasso Kratix Enterprise"},sidebar:"skeSidebar",previous:{title:"Installation via SKE CLI",permalink:"/ske/kratix/ske-cli-installation"},next:{title:"ske-cli-introduction",permalink:"/ske/ske-cli/ske-cli-intro"}},d={},u=[{value:"Install SKE operator",id:"install-ske-operator",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Configuring your values",id:"configuring-your-values",level:3},{value:"Required configuration",id:"required-configuration",level:4},{value:"SKE version",id:"ske-version",level:4},{value:"Mirrored Image Registry",id:"mirrored-image-registry",level:4},{value:"Mirrored Release Storage",id:"mirrored-release-storage",level:4},{value:"Installing the Operator",id:"installing-the-operator",level:3},{value:"Verify the installation",id:"verify-the-installation",level:3},{value:"Upgrades",id:"upgrades",level:2},{value:"Upgrading the Operator",id:"upgrading-the-operator",level:3},{value:"Upgrading the SKE Instance",id:"upgrading-the-ske-instance",level:3},{value:"Deletes",id:"deletes",level:2},{value:"Deleting the SKE Operator",id:"deleting-the-ske-operator",level:3},{value:"Deleting the SKE Instance",id:"deleting-the-ske-instance",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,r.a)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Syntasso Kratix Enterprise images are distributed through a private image registry. To\ninstall SKE on your Kubernetes cluster, follow the steps below."}),"\n",(0,a.jsx)(n.h2,{id:"install-ske-operator",children:"Install SKE operator"}),"\n",(0,a.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Syntasso Kratix Enterprise requires cert-manager to be installed on the cluster. Please\nrefer to ",(0,a.jsx)(n.a,{href:"https://cert-manager.io/",children:"its documentation for installation instructions"}),"."]})}),"\n",(0,a.jsx)(n.p,{children:"To install SKE operator using the Helm chart, start by adding the Syntasso Helm\nrepository:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm repo add syntasso https://syntasso.github.io/helm-charts\nhelm repo update\n"})}),"\n",(0,a.jsx)(n.h3,{id:"configuring-your-values",children:"Configuring your values"}),"\n",(0,a.jsxs)(n.p,{children:["Helm can accept values via the a values file. Refer to the examples\nbelow for common configuration options. Any configuration should be placed in a\n",(0,a.jsx)(n.code,{children:"values.yaml"})," file that is then passed in to the ",(0,a.jsx)(n.code,{children:"helm install"})," command."]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["You can see all available configuration in the\n",(0,a.jsx)(n.a,{href:"https://github.com/syntasso/helm-charts/blob/main/ske-operator/values.yaml",children:"helm chart repository"}),"."]})}),"\n",(0,a.jsx)(n.h4,{id:"required-configuration",children:"Required configuration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"skeLicense: LICENSE # provided to you by Syntasso\n"})}),"\n",(0,a.jsx)(n.h4,{id:"ske-version",children:"SKE version"}),"\n",(0,a.jsxs)(n.p,{children:["The Helm chart version determines what version of the SKE Operator is installed.\nTo configure the version of SKE that the operator will install, you can use the\n",(0,a.jsx)(n.code,{children:"skeDeployment.version"})," field as shown below."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"skeDeployment:\n  version: v0.99.0\n"})}),"\n",(0,a.jsx)(n.h4,{id:"mirrored-image-registry",children:"Mirrored Image Registry"}),"\n",(0,a.jsxs)(n.p,{children:["Add this configuration to your helm values file if you are following\nthe ",(0,a.jsx)(n.a,{href:"./air-gapped",children:"air-gapped setup"})," instructions for a self-hosted\nImage Registry."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'imageRegistry:\n  host: "ghcr.io"\n  imagePullSecret: "my-secret"\n  skeOperatorImage:\n    name: "syntasso/ske-operator"\n    tag: "v0.1.5"\n  skePlatformImage:\n    name: "syntasso/ske-platform"\n  skePlatformPipelineAdapterImage:\n    name: "syntasso/ske-platform-pipeline-adapter"\n'})}),"\n",(0,a.jsx)(n.h4,{id:"mirrored-release-storage",children:"Mirrored Release Storage"}),"\n",(0,a.jsxs)(n.p,{children:["Add this configuration to your helm values file if you are following\nthe ",(0,a.jsx)(n.a,{href:"./air-gapped",children:"air-gapped setup"})," instructions for a self-hosted\nRelease Storage."]}),"\n",(0,a.jsxs)(s.Z,{className:"boxedTabs",groupId:"stateStore",children:[(0,a.jsx)(i.Z,{value:"bucket",label:"Mirroring from Bucket",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'releaseStorage:\n  path: "ske" # the path within the bucket that contains the SKE Versions\n  bucket:\n    name: "syntasso-enterprise-releases"\n    region: "eu-west-2"\n      secret:\n        name: "my-secret" # the secret must be created in the same namespace as the operator. It must contain the following keys: accessKeyID, secretAccessKey. If provided below it is automatically created\n        values: # optional: if you\'ve not pre-created the secret, you can instead provide the values below and the helm chart will create it for you\n          accessKeyID: "my-access"\n          secretAccessKey: "my-secret"\n'})})}),(0,a.jsx)(i.Z,{value:"git",label:"Mirroring from Git Repo",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'releaseStorage:\n  path: "ske" # the path within the Git Repo that contains the SKE Versions\n  git:\n    branch: main\n    repo: https://github.com/org/repo\n    secret:\n      name: git-creds # the secret must be created in the same namespace as the operator. It must contain the following keys: username, password. If provided below it is automatically created\n      values: # optional: if you\'ve not pre-created the secret, you can instead provide the values below and the helm chart will create it for you\n        username: "my-username" # instead of providing a secretName you can provide the username and password directly\n        password: "my-password"\n'})})})]}),"\n",(0,a.jsxs)(t,{children:[(0,a.jsxs)("summary",{children:["Suggested starter ",(0,a.jsx)(n.code,{children:"values.yaml"})," file"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"skeLicense: your-token-here\nskeDeployment:\n  version: latest\n"})})]}),"\n",(0,a.jsxs)(t,{children:[(0,a.jsxs)("summary",{children:["Example air-gapped ",(0,a.jsx)(n.code,{children:"values.yaml"})," file"]}),(0,a.jsx)(n.p,{children:"To use this example, please set all values to your specific environment"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'  skeLicense: your-token-here\n  skeDeployment:\n    version: latest\n  imageRegistry:\n    host: "ghcr.io"\n    imagePullSecret: "my-secret"\n    skeOperatorImage:\n      name: "syntasso/ske-operator"\n      tag: "v0.1.5"\n    skePlatformImage:\n      name: "syntasso/ske-platform"\n    skePlatformPipelineAdapterImage:\n      name: "syntasso/ske-platform-pipeline-adapter"\n  releaseStorage:\n    path: "ske"\n    git:\n      branch: main\n      repo: https://github.com/org/repo\n      secret:\n        name: git-creds # the secret must be created in the same namespace as the operator. It must contain the following keys: username, password. If provided below it is automatically created\n        values:\n          username: "my-username" # instead of providing a secretName you can provide the username and password directly\n          password: "my-password"\n'})})]}),"\n",(0,a.jsx)(n.h3,{id:"installing-the-operator",children:"Installing the Operator"}),"\n",(0,a.jsx)(n.p,{children:"Next, install the SKE Operator:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm install ske-operator syntasso/ske-operator \\\n  --namespace kratix-platform-system \\\n  --create-namespace\n  --values values.yaml # This is optional. Only use if you are configuring custom values.\n"})}),"\n",(0,a.jsxs)(t,{children:[(0,a.jsx)("summary",{children:"Alternative installation method"}),(0,a.jsx)(n.p,{children:"If you prefer not to use Helm, you can install the SKE operator by applying the\nmanifests directly."}),(0,a.jsx)(n.p,{children:"First, create the namespace where the SKE operator will be installed:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl create namespace kratix-platform-system\n"})}),(0,a.jsx)(n.p,{children:"Then, create a secret with your license token:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"kubectl create secret docker-registry syntasso-registry \\\n  --namespace=kratix-platform-system \\\n  --docker-server=ghcr.io \\\n  --docker-username=syntasso-pkg \\\n  --docker-password=<YOUR TOKEN>\n"})}),(0,a.jsxs)(n.p,{children:["The manifests are available in the ",(0,a.jsx)(n.a,{href:"http://syntasso-enterprise-releases.s3-website.eu-west-2.amazonaws.com/#ske-operator/",children:"Syntasso Releases\nPage"}),".\nFind the latest release and apply it with ",(0,a.jsx)(n.code,{children:"kubectl"}),":"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f http://s3.eu-west-2.amazonaws.com/syntasso-enterprise-releases/ske-operator/<VERSION>/ske-operator-distribution.yaml\n"})}),(0,a.jsx)(n.p,{children:"With the Operator in place, you can now install Kratix Enterprise by creating a\n'Kratix' instance. Below is an example 'Kratix' instance definition:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: platform.syntasso.io/v1alpha1\nkind: Kratix\nmetadata:\n  name: kratix-example\nspec:\n  version: # version of Kratix Enterprise to install; default to the latest release found in release bucket\n"})}),(0,a.jsx)(n.p,{children:"You can save the 'Kratix' instance definition to a local file and apply with kubectl.\nSKE operator will then install Kratix Enterprise and its necessary configurations."}),(0,a.jsxs)(n.p,{children:["By default, when ",(0,a.jsx)(n.code,{children:"spec.releaseStorage"})," is not set, SKE operator will use the Syntasso Enterprise releases bucket."]}),(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.p,{children:"'Kratix' is a cluster scoped and singleton resource."}),(0,a.jsx)(n.p,{children:"Only one instance of Kratix can be installed in a cluster."})]})]}),"\n",(0,a.jsx)(n.h3,{id:"verify-the-installation",children:"Verify the installation"}),"\n",(0,a.jsx)(n.p,{children:"To verify that Kratix Enterprise has been installed successfully, run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl get deployments.apps --namespace kratix-platform-system\n"})}),"\n",(0,a.jsx)(n.p,{children:"You should see the following output:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell-session",children:"NAME                                 READY   UP-TO-DATE   AVAILABLE   AGE\nkratix-platform-controller-manager   1/1     1            1           1h\nske-operator-controller-manager      1/1     1            1           1h\n"})}),"\n",(0,a.jsx)(n.p,{children:"You can now proceed with the configuration of Kratix (i.e. registering destinations or\ninstalling promises). For that, refer to the Open-Source Kratix documentation."}),"\n",(0,a.jsx)(n.h2,{id:"upgrades",children:"Upgrades"}),"\n",(0,a.jsx)(n.h3,{id:"upgrading-the-operator",children:"Upgrading the Operator"}),"\n",(0,a.jsx)(n.p,{children:"To verify the version of the Operator installed, run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm list\n"})}),"\n",(0,a.jsx)(n.p,{children:"You should see the following output:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell-session",children:"NAME            NAMESPACE    [...]    CHART                   APP VERSION\nske-operator    default      [...]    ske-operator-0.8.0      v0.1.1\n"})}),"\n",(0,a.jsx)(n.p,{children:"To check the available versions of the Operator, run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm search repo syntasso/ske-operator --versions\n"})}),"\n",(0,a.jsx)(n.p,{children:"To upgrade, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm upgrade ske-operator syntasso/ske-operator # --version <VERSION>\n"})}),"\n",(0,a.jsx)(n.admonition,{title:"Not using Helm?",type:"info",children:(0,a.jsx)(n.p,{children:"Refer to the alternative installation method summary box above to upgrade the operator without Helm."})}),"\n",(0,a.jsx)(n.h3,{id:"upgrading-the-ske-instance",children:"Upgrading the SKE Instance"}),"\n",(0,a.jsxs)(n.p,{children:["To upgrade the version of SKE being deployed by the operator, you can edit your\nKratix instance definition and change the ",(0,a.jsx)(n.code,{children:"version"})," field to the desired\nversion."]}),"\n",(0,a.jsx)(n.p,{children:"Upgrades from a version vX.Y.Z to vX.Y+2.Z are not supported. You must upgrade to\nvX.Y+1.Z first."}),"\n",(0,a.jsx)(n.h2,{id:"deletes",children:"Deletes"}),"\n",(0,a.jsx)(n.h3,{id:"deleting-the-ske-operator",children:"Deleting the SKE Operator"}),"\n",(0,a.jsx)(n.p,{children:"To delete the SKE operator (and any deployed SKE instance), run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"helm uninstall ske-operator\n"})}),"\n",(0,a.jsx)(n.h3,{id:"deleting-the-ske-instance",children:"Deleting the SKE Instance"}),"\n",(0,a.jsx)(n.p,{children:"To delete the SKE instance, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"kubectl -n kratix-platform-system delete kratix <INSTANCE_NAME>\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},5162:(e,n,t)=>{t.d(n,{Z:()=>i});t(7294);var a=t(6905);const r={tabItem:"tabItem_Ymn6"};var s=t(5893);function i(e){let{children:n,hidden:t,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.Z)(r.tabItem,i),hidden:t,children:n})}},4866:(e,n,t)=>{t.d(n,{Z:()=>k});var a=t(7294),r=t(6905),s=t(2466),i=t(6550),l=t(469),o=t(1980),c=t(7392),d=t(812);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:r}}=e;return{value:n,label:t,attributes:a,default:r}}))}(t);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const r=(0,i.k6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o._X)(s),(0,a.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(r.location.search);n.set(s,e),r.replace({...r.location,search:n.toString()})}),[s,r])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,s=h(e),[i,o]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:s}))),[c,u]=m({queryString:t,groupId:r}),[g,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,s]=(0,d.Nk)(t);return[r,(0,a.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:r}),x=(()=>{const e=c??g;return p({value:e,tabValues:s})?e:null})();(0,l.Z)((()=>{x&&o(x)}),[x]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),f(e)}),[u,f,s]),tabValues:s}}var f=t(2389);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=t(5893);function v(e){let{className:n,block:t,selectedValue:a,selectValue:i,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.o5)(),d=e=>{const n=e.currentTarget,t=o.indexOf(n),r=l[t].value;r!==a&&(c(n),i(r))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>o.push(e),onKeyDown:u,onClick:d,...s,className:(0,r.Z)("tabs__item",x.tabItem,s?.className,{"tabs__item--active":a===n}),children:t??n},n)}))})}function b(e){let{lazy:n,children:t,selectedValue:r}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function j(e){const n=g(e);return(0,y.jsxs)("div",{className:(0,r.Z)("tabs-container",x.tabList),children:[(0,y.jsx)(v,{...n,...e}),(0,y.jsx)(b,{...n,...e})]})}function k(e){const n=(0,f.Z)();return(0,y.jsx)(j,{...e,children:u(e.children)},String(n))}},1151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>i});var a=t(7294);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);