"use strict";(self.webpackChunkkratix_docs=self.webpackChunkkratix_docs||[]).push([[146],{2386:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>i,metadata:()=>r,toc:()=>h});var n=s(5893),a=s(1151);const i={description:"Documentation for the Kratix `GitStateStore`` Custom Resource",title:"GitStateStore",sidebar_label:"GitStateStore",id:"gitstatestore"},o="GitStateStore",r={id:"main/reference/statestore/gitstatestore",title:"GitStateStore",description:"Documentation for the Kratix `GitStateStore`` Custom Resource",source:"@site/docs/main/05-reference/02-statestore/02-gitstatestore.md",sourceDirName:"main/05-reference/02-statestore",slug:"/main/reference/statestore/gitstatestore",permalink:"/main/reference/statestore/gitstatestore",draft:!1,unlisted:!1,editUrl:"https://github.com/syntasso/kratix-docs/tree/main/docs/main/05-reference/02-statestore/02-gitstatestore.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{description:"Documentation for the Kratix `GitStateStore`` Custom Resource",title:"GitStateStore",sidebar_label:"GitStateStore",id:"gitstatestore"},sidebar:"mainSidebar",previous:{title:"State Stores",permalink:"/main/reference/statestore/intro"},next:{title:"BucketStateStore",permalink:"/main/reference/statestore/bucketstatestore"}},c={},h=[{value:"Auth",id:"auth",level:2},{value:"SSH",id:"ssh",level:3},{value:"GitHub",id:"github",level:4},{value:"GitLab",id:"gitlab",level:4},{value:"Basic Auth",id:"basic-auth",level:3},{value:"GitHub",id:"github-1",level:4},{value:"GitLab",id:"gitlab-1",level:4},{value:"AWS CodeCommit",id:"aws-codecommit",level:4}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"gitstatestore",children:"GitStateStore"}),"\n",(0,n.jsx)(t.p,{children:"Kratix supports writing to Git repositories. See below for the API documentation:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"apiVersion: platform.kratix.io/v1alpha1\nkind: GitStateStore\nmetadata:\n  name: default\nspec:\n  # The branch to write to: optional, defaults to main\n  branch: main\n  # The top-level path in the git repository to write to: optional\n  path: destinations/\n  # Valid options: basicAuth, and ssh; defaults to basicAuth\n  authMethod: basicAuth\n  # Optional\n  gitAuthor:\n    # The name of the author to use when committing: optional, defaults to kratix\n    name: kratix\n    # The email of the author to use when committing: optional, defaults to empty\n    email:\n  # Required\n  secretRef:\n    # The name and namespace of the secret to use to authenticate: required\n    name: gitea-credentials\n    namespace: default\n  # The address of the git repository. If auth method is basic auth, use `http`/`https` format: required\n  # if your using ssh auth then ensure its of the format git@github.com:<org>/<repo>.git\n  url: https://github.com/syntasso/kratix-repo\n"})}),"\n",(0,n.jsx)(t.h2,{id:"auth",children:"Auth"}),"\n",(0,n.jsxs)(t.p,{children:["Kratix uses the credentials contained in the ",(0,n.jsx)(t.code,{children:"secretRef"})," to authenticate with the\nGit storage. Kratix currently supports using ",(0,n.jsx)(t.code,{children:"basicAuth"})," or ",(0,n.jsx)(t.code,{children:"ssh"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"ssh",children:"SSH"}),"\n",(0,n.jsxs)(t.p,{children:["When ",(0,n.jsx)(t.code,{children:"authMethod"})," is equal to ",(0,n.jsx)(t.code,{children:"ssh"})," Kratix will check the secret for ",(0,n.jsx)(t.code,{children:"sshPrivateKey"})," and ",(0,n.jsx)(t.code,{children:"knownHosts"}),"\nto authenticate. The secret should be in the following format:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: # name\n  namespace: # namespace\ntype: Opaque\ndata:\n  sshPrivateKey: # base64 encoded private key\n  knownHosts: # base64 encoded known hosts\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Kratix supports ",(0,n.jsx)(t.strong,{children:"any"})," Git provider that supports ssh auth. Depending on the provider\nyou are using you may be able to use an per-repo ssh key in-place of user's ssh key.\nSee below for further details."]}),"\n",(0,n.jsx)(t.h4,{id:"github",children:"GitHub"}),"\n",(0,n.jsxs)(t.p,{children:["GitHub supports per-repo ssh keys using ",(0,n.jsx)(t.a,{href:"https://docs.github.com/en/rest/deploy-keys/deploy-keys?apiVersion=2022-11-28",children:"deploy keys"}),"."]}),"\n",(0,n.jsx)(t.h4,{id:"gitlab",children:"GitLab"}),"\n",(0,n.jsxs)(t.p,{children:["GitLab supports per-repo ssh keys using ",(0,n.jsx)(t.a,{href:"https://docs.gitlab.com/ee/user/project/deploy_keys/",children:"deploy keys"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"basic-auth",children:"Basic Auth"}),"\n",(0,n.jsxs)(t.p,{children:["When ",(0,n.jsx)(t.code,{children:"authMethod"})," is equal to ",(0,n.jsx)(t.code,{children:"basicAuth"})," Kratix will check the secret for ",(0,n.jsx)(t.code,{children:"username"}),"\nand ",(0,n.jsx)(t.code,{children:"password"})," to authenticate. The secret should be in the following format:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: # name\n  namespace: # namespace\ntype: Opaque\ndata:\n  username: # base64 encoded username\n  password: # base64 encoded password\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Kratix supports ",(0,n.jsx)(t.strong,{children:"any"})," Git provider that supports basic auth. Depending on the provider\nyou are using you may be able to use an access token in-place of an actual password.\nSee below for further details."]}),"\n",(0,n.jsx)(t.h4,{id:"github-1",children:"GitHub"}),"\n",(0,n.jsxs)(t.p,{children:["GitHub supports using ",(0,n.jsx)(t.a,{href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token",children:"personal access tokens"}),"\ninstead of user passwords for authenticating with GitHub. Create a personal access token\nwith read and write permissions to the repository. Populate the ",(0,n.jsx)(t.code,{children:"username"})," and ",(0,n.jsx)(t.code,{children:"password"}),"\nfields with the GitHub username and token value."]}),"\n",(0,n.jsx)(t.h4,{id:"gitlab-1",children:"GitLab"}),"\n",(0,n.jsxs)(t.p,{children:["GitLab supports using ",(0,n.jsx)(t.a,{href:"https://docs.gitlab.com/ee/user/project/settings/project_access_tokens.html",children:"project access tokens"}),"\ninstead of user passwords for authenticating with GitLab. Create a project access token\nwith read and write permissions to the repository. The token is created on the project, and is therefore\nnot related to any individual user. Populate the ",(0,n.jsx)(t.code,{children:"username"})," field with any value and\nthe ",(0,n.jsx)(t.code,{children:"password"})," field with the token value."]}),"\n",(0,n.jsx)(t.h4,{id:"aws-codecommit",children:"AWS CodeCommit"}),"\n",(0,n.jsxs)(t.p,{children:["AWS CodeCommit supports using ",(0,n.jsx)(t.a,{href:"https://docs.aws.amazon.com/codecommit/latest/userguide/setting-up-gc.html?icmpid=docs_acc_console_connect_np#setting-up-gc-iam",children:"basic\nauth"}),"\nto authenticate with the repository. Populate the ",(0,n.jsx)(t.code,{children:"username"})," and ",(0,n.jsx)(t.code,{children:"password"}),"\nfield with the values generated for the HTTPS Git credentials."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsxs)(t.p,{children:["Require a different method of authentication? Get in touch with us at\n",(0,n.jsx)(t.a,{href:"mailto:feedback@syntasso.io?subject=Kratix%20Feedback",children:"feedback@syntasso.io"}),"\nor ",(0,n.jsx)(t.a,{href:"https://github.com/syntasso/kratix/issues/new",children:"open a GitHub Issue"}),"."]})]})}function l(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>r,a:()=>o});var n=s(7294);const a={},i=n.createContext(a);function o(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);